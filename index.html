<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1.0"
  />
  <title>ì˜¤ëŠ˜ì˜ íƒ€ë¡œ ìš´ì„¸</title>

  <link rel="manifest" href="manifest.webmanifest" />
  <meta name="theme-color" content="#111322" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="íƒ€ë¡œ ì˜¤ëŠ˜ì˜ ìš´ì„¸" />
  <link rel="apple-touch-icon" href="icons/icon-192.png" />

  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Apple SD Gothic Neo","Noto Sans KR", sans-serif;
      background: radial-gradient(circle at top, #3f51b5, #111);
      color: #f9f9ff;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 16px;
    }
    .app {
      max-width: 520px;
      width: 100%;
      background: rgba(10, 10, 30, 0.9);
      border-radius: 24px;
      padding: 20px 18px 24px;
      box-shadow: 0 12px 40px rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(16px);
      overflow: hidden;
    }
    .app-header { text-align: center; margin-bottom: 16px; }
    .title {
      font-size: 1.3rem; font-weight: 700;
      letter-spacing: 0.06em; text-transform: uppercase; color: #b3c6ff;
    }
    .subtitle { font-size: 0.92rem; margin-top: 4px; color: #d0d4ff; opacity: 0.9; }
    .date-text { margin-top: 8px; font-size: 0.8rem; opacity: 0.8; }
    .section-block { margin-top: 14px; padding-top: 14px; border-top: 1px solid rgba(120,144,156,0.3); }
    .section-heading {
      font-size: 0.9rem; font-weight: 600; color: #c5cae9;
      margin-bottom: 8px; display: flex; align-items: center; gap: 6px;
    }
    .badge {
      font-size: 0.7rem; padding: 2px 8px; border-radius: 999px;
      border: 1px solid rgba(187,222,251,0.7); color: #bbdefb;
    }
    .card-area { display: flex; flex-direction: column; align-items: center; margin: 8px 0 10px; }
    .tarot-card {
      width: 180px; height: 280px; border-radius: 16px;
      background: radial-gradient(circle at top, #2c2f5e, #0c0f24);
      border: 1px solid rgba(255,255,255,0.18);
      box-shadow: 0 10px 30px rgba(0,0,0,0.5);
      padding: 14px; display: flex; flex-direction: column; justify-content: space-between;
      position: relative; transform-style: preserve-3d;
      transition: transform 0.4s ease, background 0.3s ease; overflow: hidden;
    }
    .tarot-card.flipped { transform: rotateX(180deg); }
    .tarot-card::before {
      content: "âœ¶"; position: absolute; top: 8px; right: 10px;
      font-size: 0.9rem; opacity: 0.7;
    }
    .card-top-label {
      font-size: 0.75rem; letter-spacing: 0.16em;
      text-transform: uppercase; color: #c5cae9; opacity: 0.85;
    }
    .card-name { margin-top: 12px; font-size: 1.1rem; font-weight: 700; line-height: 1.3; }
    .card-orientation { margin-top: 6px; font-size: 0.8rem; opacity: 0.9; }
    .card-keyword { margin-top: 12px; font-size: 0.85rem; font-weight: 600; color: #ffeb3b; }
    .card-bottom-label { font-size: 0.75rem; text-align: right; opacity: 0.7; }
    .tag {
      display: inline-block; font-size: 0.75rem; padding: 4px 8px; border-radius: 999px;
      border: 1px solid rgba(187,222,251,0.5); color: #bbdefb; margin-top: 10px;
    }
    .sections { margin-top: 10px; }
    .section { margin-bottom: 8px; }
    .section-title { font-size: 0.85rem; font-weight: 600; color: #c5cae9; margin-bottom: 2px; }
    .section-body { font-size: 0.85rem; line-height: 1.4; color: #e8eaf6; opacity: 0.95; }
    .hint { font-size: 0.8rem; margin-top: 4px; color: #9fa8da; opacity: 0.9; }
    .btn-area { margin-top: 10px; display: flex; gap: 8px; flex-wrap: wrap; }
    button {
      border: none; border-radius: 999px; padding: 10px 14px;
      font-size: 0.9rem; font-weight: 600; cursor: pointer; flex: 1;
      transition: transform 0.12s ease, box-shadow 0.12s ease, opacity 0.15s;
    }
    .btn-primary {
      background: linear-gradient(135deg, #7986cb, #536dfe);
      color: #fff; box-shadow: 0 4px 14px rgba(83,109,254,0.5);
    }
    .btn-primary:active { transform: translateY(1px) scale(0.99); box-shadow: 0 2px 6px rgba(83,109,254,0.4); }
    .btn-secondary {
      background: transparent; color: #c5cae9; border: 1px solid rgba(197,202,233,0.5);
    }
    .btn-secondary:active { transform: translateY(1px) scale(0.99); }
    .btn-ghost {
      background: rgba(255,255,255,0.04); color: #bbdefb;
      border: 1px dashed rgba(187,222,251,0.6);
    }
    .footer { margin-top: 10px; text-align: center; font-size: 0.72rem; color: #9fa8da; opacity: 0.8; }
    .spread-cards {
      display: flex; gap: 8px; justify-content: space-between; margin-top: 6px; flex-wrap: wrap;
    }
    .spread-card-wrapper { flex: 1; min-width: 95px; }
    .spread-card-label { font-size: 0.75rem; text-align: center; margin-bottom: 4px; color: #c5cae9; opacity: 0.9; }
    .spread-card {
      width: 100%; height: 170px; border-radius: 12px; padding: 8px;
      background: linear-gradient(145deg, #1d2340, #283593);
      border: 1px solid rgba(255,255,255,0.15);
      box-shadow: 0 6px 18px rgba(0,0,0,0.45);
      position: relative; font-size: 0.78rem;
      display: flex; flex-direction: column; justify-content: space-between;
      transition: transform 0.25s ease; overflow: hidden;
    }
    .spread-card.flipped { transform: rotateY(180deg); }
    .spread-card-name { font-weight: 600; line-height: 1.25; }
    .spread-card-orientation { font-size: 0.73rem; opacity: 0.9; margin-top: 4px; }
    .spread-card-keyword { font-size: 0.75rem; margin-top: 6px; color: #ffeb3b; font-weight: 500; }
    .spread-card::before {
      content: "âœ¦"; position: absolute; top: 6px; right: 8px; font-size: 0.8rem; opacity: 0.7;
    }
    .spread-meaning { margin-top: 8px; font-size: 0.8rem; line-height: 1.4; color: #e8eaf6; opacity: 0.95; }
    @media (max-width: 380px) {
      .tarot-card { width: 160px; height: 250px; }
      .spread-card { height: 160px; font-size: 0.75rem; }
    }
  </style>
</head>
<body>
  <div class="app">
    <header class="app-header">
      <div class="title">ì˜¤ëŠ˜ì˜ íƒ€ë¡œ ìš´ì„¸</div>
      <div class="subtitle">í•œ ì¥ìœ¼ë¡œ ê°€ë³ê²Œ, 3ì¥ìœ¼ë¡œ ê¹Šê²Œ ğŸ”®</div>
      <div class="date-text" id="todayText"></div>
    </header>

    <main>
      <section class="section-block">
        <div class="section-heading">
          <span>ì˜¤ëŠ˜ì˜ í•œ ì¥</span>
          <span class="badge">í•˜ë£¨ 1íšŒ ê³ ì •</span>
        </div>

        <div class="card-area">
          <div class="tarot-card" id="tarotCard">
            <div>
              <div class="card-top-label">TODAY'S TAROT</div>
              <div class="card-name" id="cardName">ì•„ì§ ì¹´ë“œë¥¼ ë½‘ì§€ ì•Šì•˜ì–´ìš”</div>
              <div class="card-orientation" id="cardOrientation">ë²„íŠ¼ì„ ëˆŒëŸ¬ ì˜¤ëŠ˜ì˜ ì¹´ë“œë¥¼ ë½‘ì•„ë³´ì„¸ìš”.</div>
              <div class="card-keyword" id="cardKeyword"></div>
            </div>
            <div class="card-bottom-label">í•˜ë£¨ 1íšŒ ì¶”ì²œ</div>
          </div>
          <span class="tag" id="cardTag">ê°€ë³ê²Œ ì¦ê¸°ëŠ” ìš´ì„¸</span>
        </div>

        <div class="sections" id="sections">
          <div class="section">
            <div class="section-title">ì˜¤ëŠ˜ì˜ í•œ ì¤„ ì¡°ì–¸</div>
            <div class="section-body" id="adviceText">
              ì¹´ë“œë¥¼ ë½‘ì•„ì„œ ì˜¤ëŠ˜ì˜ ë©”ì‹œì§€ë¥¼ ë°›ì•„ë³´ì„¸ìš”.
            </div>
          </div>

          <div class="section">
            <div class="section-title">ì „ì²´ ìš´</div>
            <div class="section-body" id="overallText">
              ì˜¤ëŠ˜ì˜ ì¹´ë“œê°€ ì •í•´ì§€ë©´ ì „ë°˜ì ì¸ íë¦„ì„ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤.
            </div>
          </div>

          <div class="section">
            <div class="section-title">ì‚¬ë‘ Â· ê´€ê³„ ìš´</div>
            <div class="section-body" id="loveText">
              ì¸ê°„ê´€ê³„, ì—°ì• , ê°€ì¡±, ë™ë£Œì™€ì˜ ê´€ê³„ íë¦„ì„ ì²´í¬í•´ë³´ì„¸ìš”.
            </div>
          </div>

          <div class="section">
            <div class="section-title">ì¼ Â· ê¸ˆì „ ìš´</div>
            <div class="section-body" id="workText">
              ì¼, ê¸ˆì „, ê³„íšê³¼ ê´€ë ¨ëœ ë©”ì‹œì§€ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            </div>
          </div>
        </div>

        <p class="hint">
          â€» ì´ íƒ€ë¡œëŠ” ì—”í„°í…Œì¸ë¨¼íŠ¸ìš©ì…ë‹ˆë‹¤. ì¤‘ìš”í•œ ê²°ì •ì€ í•­ìƒ ìŠ¤ìŠ¤ë¡œì˜ íŒë‹¨ìœ¼ë¡œ í•´ì£¼ì„¸ìš”.
        </p>

        <div class="btn-area">
          <button class="btn-primary" id="drawButton">ì˜¤ëŠ˜ì˜ ì¹´ë“œ ë½‘ê¸°</button>
          <button class="btn-secondary" id="resetButton">ì˜¤ëŠ˜ ê¸°ë¡ ì´ˆê¸°í™”</button>
        </div>
        <div class="btn-area">
          <button class="btn-ghost" id="shareButton">ì˜¤ëŠ˜ ìš´ì„¸ ê³µìœ í•˜ê¸°</button>
        </div>
      </section>

      <section class="section-block">
        <div class="section-heading">
          <span>3ì¥ ìŠ¤í”„ë ˆë“œ</span>
          <span class="badge">ê³¼ê±° Â· í˜„ì¬ Â· ë¯¸ë˜</span>
        </div>

        <div class="spread-cards">
          <div class="spread-card-wrapper">
            <div class="spread-card-label">ê³¼ê±°</div>
            <div class="spread-card" id="spreadPast">
              <div class="spread-card-name">ì¹´ë“œë¥¼ ë½‘ì•„ë³´ì„¸ìš”</div>
              <div class="spread-card-orientation"></div>
              <div class="spread-card-keyword"></div>
            </div>
          </div>
          <div class="spread-card-wrapper">
            <div class="spread-card-label">í˜„ì¬</div>
            <div class="spread-card" id="spreadPresent">
              <div class="spread-card-name">ì¹´ë“œë¥¼ ë½‘ì•„ë³´ì„¸ìš”</div>
              <div class="spread-card-orientation"></div>
              <div class="spread-card-keyword"></div>
            </div>
          </div>
          <div class="spread-card-wrapper">
            <div class="spread-card-label">ë¯¸ë˜</div>
            <div class="spread-card" id="spreadFuture">
              <div class="spread-card-name">ì¹´ë“œë¥¼ ë½‘ì•„ë³´ì„¸ìš”</div>
              <div class="spread-card-orientation"></div>
              <div class="spread-card-keyword"></div>
            </div>
          </div>
        </div>

        <div class="spread-meaning" id="spreadMeaning">
          3ì¥ ìŠ¤í”„ë ˆë“œëŠ” ê³¼ê±°â€“í˜„ì¬â€“ë¯¸ë˜ íë¦„ì„ í•œ ë²ˆì— ë³´ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.  
          ì•„ë˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ ì¹´ë“œë¥¼ ë½‘ì•„ë³´ì„¸ìš”.
        </div>

        <div class="btn-area" style="margin-top: 10px;">
          <button class="btn-primary" id="drawSpreadButton">3ì¥ ë½‘ê¸°</button>
        </div>

        <p class="hint">
          â€» 3ì¥ ìŠ¤í”„ë ˆë“œëŠ” ë²„íŠ¼ì„ ëˆ„ë¥¼ ë•Œë§ˆë‹¤ ìƒˆë¡­ê²Œ ë½‘í™ë‹ˆë‹¤.
        </p>
      </section>

      <div class="footer">
        ì˜¤ëŠ˜ í•œ ì¥ ì¹´ë“œëŠ” ê°™ì€ ê¸°ê¸°Â·ë¸Œë¼ìš°ì €ì—ì„œ í•˜ë£¨ì— í•œ ë²ˆ ê°™ì€ ì¹´ë“œê°€ ìœ ì§€ë©ë‹ˆë‹¤.
      </div>
    </main>
  </div>

  <script>
    const TAROT_CARDS = [
      {
        name: "0. ê´‘ëŒ€ (The Fool)",
        keyword: "ìƒˆë¡œìš´ ì‹œì‘ Â· ìˆœìˆ˜í•œ ë„ì „",
        upright: {
          advice: "ë§ˆìŒì´ ëŒë¦¬ëŠ” ë°©í–¥ìœ¼ë¡œ ê°€ë³ê²Œ í•œ ë°œ ë‚´ë”›ì–´ ë³´ì„¸ìš”.",
          overall: "ìƒˆë¡œìš´ ì‹œì‘, ì—¬í–‰, ëª¨í—˜ì— ì¢‹ì€ ë‚ ì…ë‹ˆë‹¤. ê²°ê³¼ë³´ë‹¤ëŠ” ê³¼ì •ì— ì§‘ì¤‘í•´ ë³´ì„¸ìš”.",
          love: "ê°€ë²¼ìš´ ë§Œë‚¨, ì„¤ë ˆëŠ” ì¸ì—°ì´ ë‹¤ê°€ì˜¬ ìˆ˜ ìˆì–´ìš”. ë„ˆë¬´ ê³„ì‚°ì ìœ¼ë¡œ í–‰ë™í•˜ì§€ ë§ˆì„¸ìš”.",
          work: "ìƒˆë¡œìš´ ì•„ì´ë””ì–´ë‚˜ í”„ë¡œì íŠ¸ì— ë„ì „í•˜ê¸° ì¢‹ì€ ì‹œê¸°ì…ë‹ˆë‹¤. ë‹¤ë§Œ ê¸°ë³¸ì€ ê¼­ ì±™ê¸°ì„¸ìš”."
        },
        reversed: {
          advice: "ì¶©ë™ì  ì„ íƒì€ ì ì‹œ ë¯¸ë£¨ê³ , í•œ ë²ˆ ë” ì ê²€í•´ ë³´ì„¸ìš”.",
          overall: "ë¬´ê³„íší•œ í–‰ë™ì´ë‚˜ ì‹¤ìˆ˜ê°€ ìƒê¸°ê¸° ì‰¬ìš´ ë‚ ì…ë‹ˆë‹¤. ì„œë‘ë¥´ì§€ ì•ŠëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.",
          love: "ê°ì •ì ìœ¼ë¡œ íŠ€ëŠ” í–‰ë™ì„ ì¡°ì‹¬í•˜ì„¸ìš”. ìƒëŒ€ë¥¼ ì¶©ë¶„íˆ ë°°ë ¤í•˜ëŠ” íƒœë„ê°€ í•„ìš”í•©ë‹ˆë‹¤.",
          work: "ì •ë³´ ë¶€ì¡±, ì¤€ë¹„ ë¶€ì¡±ìœ¼ë¡œ ì‹¤ìˆ˜ê°€ ìƒê¸¸ ìˆ˜ ìˆì–´ìš”. ë‹¤ì‹œ í•œ ë²ˆ ê³„íšì„ ì ê²€í•˜ì„¸ìš”."
        }
      },
      {
        name: "1. ë§ˆë²•ì‚¬ (The Magician)",
        keyword: "ëŠ¥ë ¥ ë°œíœ˜ Â· ê¸°íšŒ í¬ì°©",
        upright: {
          advice: "ì§€ê¸ˆ ê°€ì§„ ëŠ¥ë ¥ê³¼ ìì›ì„ ë¯¿ê³  í•œ ë²ˆ ë°€ì–´ë¶™ì—¬ ë³´ì„¸ìš”.",
          overall: "ì§‘ì¤‘ë ¥ê³¼ í‘œí˜„ë ¥ì´ ë†’ì•„ì§€ëŠ” ë‚ ì…ë‹ˆë‹¤. ì›í•˜ëŠ” ê²ƒì„ ë§ê³¼ í–‰ë™ìœ¼ë¡œ ë¶„ëª…íˆ ë“œëŸ¬ë‚´ ë³´ì„¸ìš”.",
          love: "ë§¤ë ¥ê³¼ ë§ë¹¨ì´ ì˜ í†µí•˜ëŠ” ë‚ ì´ì—ìš”. ì†”ì§í•œ í‘œí˜„ì´ ì¢‹ì€ ê²°ê³¼ë¥¼ ë¶€ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
          work: "í”„ë ˆì  í…Œì´ì…˜, í˜‘ìƒ, ê³„ì•½ì— ìœ ë¦¬í•œ íë¦„ì…ë‹ˆë‹¤. ìŠ¤ìŠ¤ë¡œì˜ ì‹¤ë ¥ì„ ë³´ì—¬ì£¼ì„¸ìš”."
        },
        reversed: {
          advice: "ë§ë³´ë‹¤ í–‰ë™, ê³¼ì¥ë³´ë‹¤ ì§„ì‹¤í•¨ì´ ë” í•„ìš”í•œ ë‚ ì…ë‹ˆë‹¤.",
          overall: "ê²‰ê³¼ ì†ì´ ë‹¤ë¥¸ ì œì•ˆì´ë‚˜ ì‚¬ëŒì„ ì¡°ì‹¬í•´ì•¼ í•©ë‹ˆë‹¤. ë„ˆë¬´ ë‹¬ì½¤í•œ ë§ì€ í•œ ë²ˆ ë” í™•ì¸í•˜ì„¸ìš”.",
          love: "ë§ë§Œ ì•ì„œëŠ” ê´€ê³„, ë°€ë‹¹ì´ ì‹¬í•œ ê´€ê³„ë¼ë©´ í”¼ë¡œê°ì´ ìŒ“ì¼ ìˆ˜ ìˆì–´ìš”.",
          work: "ì‹¤ë ¥ ì´ìƒìœ¼ë¡œ í¬ì¥í•˜ë ¤ë‹¤ ë“¤í†µë‚  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•  ìˆ˜ ìˆëŠ” ë²”ìœ„ë¥¼ ì†”ì§í•˜ê²Œ ë§í•˜ì„¸ìš”."
        }
      },
      {
        name: "2. ì—¬ì‚¬ì œ (The High Priestess)",
        keyword: "ì§ê´€ Â· ì¹¨ì°©í•¨",
        upright: {
          advice: "ë‹¹ì¥ ë‹µì„ ë‚´ë¦¬ë ¤ í•˜ê¸°ë³´ë‹¤, ì¡°ìš©íˆ ìŠ¤ìŠ¤ë¡œì˜ ë§ˆìŒì„ ê´€ì°°í•´ë³´ì„¸ìš”.",
          overall: "ê²‰ìœ¼ë¡œ ë“œëŸ¬ë‚˜ì§€ ì•Šì€ ì •ë³´ì™€ ì§„ì‹¤ì„ ì½ì–´ë‚´ê¸° ì¢‹ì€ ë‚ ì…ë‹ˆë‹¤.",
          love: "ë§ë³´ë‹¤ëŠ” ëˆˆë¹›ê³¼ ë¶„ìœ„ê¸°ë¡œ ë§ì€ ê²ƒì„ ëŠë‚„ ìˆ˜ ìˆì–´ìš”. ì„£ë¶ˆë¦¬ ë‹¨ì • ì§“ì§€ ë§ˆì„¸ìš”.",
          work: "ë°ì´í„° ë¶„ì„, ê³µë¶€, ì¡°ìš©í•œ ì¤€ë¹„ì— ì¢‹ìŠµë‹ˆë‹¤. ë³´ì—¬ì£¼ê¸°ë³´ë‹¤ ì‹¤ë ¥ì„ ìŒ“ëŠ” ë° ì§‘ì¤‘í•˜ì„¸ìš”."
        },
        reversed: {
          advice: "í˜¼ìì„œë§Œ ë™ë™ ì•“ì§€ ë§ê³ , ë¯¿ì„ ìˆ˜ ìˆëŠ” ì‚¬ëŒê³¼ ê°ì •ì„ ë‚˜ëˆ ë³´ì„¸ìš”.",
          overall: "ì˜¤í•´, ë¶ˆì‹ ì´ ìƒê¸°ê¸° ì‰½ìŠµë‹ˆë‹¤. í™•ì‹¤í•˜ì§€ ì•Šì€ ì •ë³´ëŠ” í¼ëœ¨ë¦¬ì§€ ë§ˆì„¸ìš”.",
          love: "ì—°ë½, í‘œí˜„ì´ ë¶€ì¡±í•´ ìƒëŒ€ê°€ ë¶ˆì•ˆí•  ìˆ˜ ìˆì–´ìš”. ë§ˆìŒì„ ì¡°ê¸ˆ ë” ë“œëŸ¬ë‚´ ì£¼ì„¸ìš”.",
          work: "ê°ì •ì ìœ¼ë¡œ ì˜ˆë¯¼í•´ì§ˆ ìˆ˜ ìˆëŠ” ë‚ ì…ë‹ˆë‹¤. ì¤‘ìš”í•œ ê²°ì •ì€ í•˜ë£¨ ë¯¸ë£¨ëŠ” ê²ƒë„ ë°©ë²•ì…ë‹ˆë‹¤."
        }
      },
      {
        name: "3. ì—¬í™©ì œ (The Empress)",
        keyword: "í’ìš” Â· ì•ˆì • Â· ë‹¤ì •í•¨",
        upright: {
          advice: "ë‚˜ì™€ ì£¼ë³€ì„ ì•„ê»´ì£¼ê³  ëŒë³´ëŠ” ë§Œí¼, í’ìš”ê°€ ëŒì•„ì˜¬ ê±°ì˜ˆìš”.",
          overall: "íœ´ì‹, ì¦ê±°ì›€, í’ìš”ë¥¼ ëŠë¼ê¸° ì¢‹ì€ ë‚ ì…ë‹ˆë‹¤. ì˜¤ëŠ˜ë§Œí¼ì€ ì¡°ê¸ˆ ì—¬ìœ ë¥¼ í—ˆë½í•´ ì£¼ì„¸ìš”.",
          love: "ë”°ëœ»í•œ êµê°ê³¼ ì• ì • í‘œí˜„ì— ì¢‹ì€ íë¦„ì…ë‹ˆë‹¤. ì§‘, ì¹´í˜ì—ì„œ í¸ì•ˆí•œ ì‹œê°„ì„ ë³´ë‚´ë³´ì„¸ìš”.",
          work: "ê·¸ë™ì•ˆì˜ ë…¸ë ¥ì— ëŒ€í•œ ì‘ì€ ë³´ìƒì´ ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¸ê°„ê´€ê³„ë„ ë¶€ë“œëŸ½ê²Œ í˜ëŸ¬ê°‘ë‹ˆë‹¤."
        },
        reversed: {
          advice: "íƒ€ì¸ì„ ì±™ê¸°ëŠë¼ ë„ˆë¬´ ì§€ì¹˜ì§€ ì•Šì•˜ëŠ”ì§€ ìŠ¤ìŠ¤ë¡œì—ê²Œ ë¬¼ì–´ë³´ì„¸ìš”.",
          overall: "ì—ë„ˆì§€ ê³¼ì†Œë¹„, ê°ì • ê³¼íˆ¬ìê°€ ìš°ë ¤ë©ë‹ˆë‹¤. ìê¸° ê´€ë¦¬ì— ì‹ ê²½ ì“°ì„¸ìš”.",
          love: "ì§‘ì°©, ê³¼í•œ ê¸°ëŒ€ê°€ ê´€ê³„ë¥¼ ë¬´ê²ê²Œ ë§Œë“¤ ìˆ˜ ìˆì–´ìš”. ì„œë¡œì˜ ê³µê°„ì„ ì¡´ì¤‘í•´ ì£¼ì„¸ìš”.",
          work: "ê²Œìœ¼ë¦„ ë˜ëŠ” ê³¼í•œ ë¬´ë¦¬ ë‘˜ ë‹¤ ì¡°ì‹¬í•´ì•¼ í•©ë‹ˆë‹¤. ê· í˜• ì¡íŒ í˜ì´ìŠ¤ê°€ ì¤‘ìš”í•©ë‹ˆë‹¤."
        }
      },
      {
        name: "4. í™©ì œ (The Emperor)",
        keyword: "ì±…ì„ Â· ë¦¬ë”ì‹­ Â· êµ¬ì¡°",
        upright: {
          advice: "ì˜¤ëŠ˜ë§Œí¼ì€ ì£¼ë„ì ìœ¼ë¡œ ê²°ì •í•˜ê³  ì±…ì„ì§€ëŠ” íƒœë„ë¥¼ ê°€ì ¸ë³´ì„¸ìš”.",
          overall: "ê³„íš, ê·œì¹™, ì›ì¹™ì„ ì„¸ìš°ê¸°ì— ì¢‹ì€ ë‚ ì…ë‹ˆë‹¤. í˜„ì‹¤ì ì¸ íŒë‹¨ì´ ì˜ ì‘ë™í•©ë‹ˆë‹¤.",
          love: "ë“ ë“ í•˜ì§€ë§Œ ë‹¤ì†Œ ë”±ë”±í•œ ë¶„ìœ„ê¸°ê°€ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë¶€ë“œëŸ¬ìš´ ë§ í•œë§ˆë””ë¥¼ ë”í•´ë³´ì„¸ìš”.",
          work: "ë¦¬ë”ì‹­ê³¼ ê²°ë‹¨ë ¥ì´ ìš”êµ¬ë˜ëŠ” ìƒí™©ì—ì„œ ë¹›ì„ ë°œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."
        },
        reversed: {
          advice: "ë‚´ ë°©ì‹ë§Œ ê³ ì§‘í•˜ì§€ ë§ê³ , ì£¼ë³€ ì˜ê²¬ì—ë„ ê·€ë¥¼ ê¸°ìš¸ì—¬ ë³´ì„¸ìš”.",
          overall: "ê¶Œìœ„ì ì¸ íƒœë„, ê³ ì§‘ì´ ê°ˆë“±ì„ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìœ ì—°í•¨ì´ í•„ìš”í•œ ë‚ ì…ë‹ˆë‹¤.",
          love: "ê°ì • í‘œí˜„ ë¶€ì¡±, ì¼ ì¤‘ì‹¬ì ì¸ íƒœë„ê°€ ìƒëŒ€ë¥¼ ì„œìš´í•˜ê²Œ ë§Œë“¤ ìˆ˜ ìˆì–´ìš”.",
          work: "ë„ˆë¬´ í†µì œí•˜ë ¤ê³  í•˜ë©´ ì˜¤íˆë ¤ íš¨ìœ¨ì´ ë–¨ì–´ì§‘ë‹ˆë‹¤. ë§¡ê¸¸ ê²ƒì€ ë¯¿ê³  ë§¡ê¸°ì„¸ìš”."
        }
      },
      {
        name: "10. ìš´ëª…ì˜ ìˆ˜ë ˆë°”í€´ (Wheel of Fortune)",
        keyword: "ì „í™˜ì  Â· ìš°ì—°í•œ ê¸°íšŒ",
        upright: {
          advice: "íë¦„ì´ ë°”ë€ŒëŠ” ì§€ì ì„ ì˜ ìºì¹˜í•´ ë³´ì„¸ìš”. ì‘ì€ ê¸°íšŒë„ í˜ë ¤ë³´ë‚´ì§€ ë§ˆì„¸ìš”.",
          overall: "ì˜ˆìƒ ë°–ì˜ ë³€í™”, ìš°ì—°í•œ í–‰ìš´ì´ ì°¾ì•„ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìœ ì—°í•˜ê²Œ ëŒ€ì‘í•´ ë³´ì„¸ìš”.",
          love: "ìš°ì—°í•œ ë§Œë‚¨, ê´€ê³„ì˜ ì „í™˜ì ì´ ìƒê¸¸ ìˆ˜ ìˆì–´ìš”. íë¦„ì„ ë¯¿ì–´ë³´ëŠ” ê²ƒë„ ì¢‹ìŠµë‹ˆë‹¤.",
          work: "í”„ë¡œì íŠ¸, ì§ì¥, ì—…ë¬´ íë¦„ì— ë³€í™”ê°€ ìƒê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë³€í™”ì— ì˜¬ë¼íƒ€ëŠ” ìª½ì´ ìœ ë¦¬í•©ë‹ˆë‹¤."
        },
        reversed: {
          advice: "êµ³ì´ ì§€ê¸ˆ ì–µì§€ë¡œ ë°€ì–´ë¶™ì´ê¸°ë³´ë‹¤, íƒ€ì´ë°ì„ ë‹¤ì‹œ ë³´ëŠ” ê²ƒë„ ê´œì°®ì•„ìš”.",
          overall: "íƒ€ì´ë°ì´ ì–´ê¸‹ë‚˜ëŠ” ëŠë‚Œì´ ë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ë§Œ ì´ ë˜í•œ ì§€ë‚˜ê°€ëŠ” íë¦„ì…ë‹ˆë‹¤.",
          love: "ì—‡ê°ˆë¦¼, íƒ€ì´ë° ë¶ˆì¼ì¹˜ê°€ ìˆì„ ìˆ˜ ìˆì–´ìš”. ì¡°ê¸‰í•¨ì„ ë‚´ë ¤ë†“ëŠ” ê²ƒì´ í•„ìš”í•©ë‹ˆë‹¤.",
          work: "ê³„íšì´ ìê¾¸ ê¼¬ì¼ ìˆ˜ ìˆìœ¼ë‹ˆ, ë°±ì—… í”Œëœì„ ì¤€ë¹„í•´ ë‘ë©´ ì¢‹ìŠµë‹ˆë‹¤."
        }
      },
      {
        name: "13. ì£½ìŒ (Death)",
        keyword: "ëë§ºìŒ Â· ìƒˆì¶œë°œ",
        upright: {
          advice: "ì´ë¯¸ ëë‚œ ê²ƒì— ë§¤ë‹¬ë¦¬ê¸°ë³´ë‹¤, ìƒˆë¡œìš´ ì‹œì‘ì„ ìœ„í•œ ì •ë¦¬ë¥¼ í•´ë³´ì„¸ìš”.",
          overall: "ë¬´ì–¸ê°€ê°€ ë§ˆë¬´ë¦¬ë˜ê±°ë‚˜, ì •ë¦¬ì˜ í•„ìš”ì„±ì´ ê°•í•´ì§€ëŠ” ë‚ ì…ë‹ˆë‹¤.",
          love: "ë‚¡ì€ íŒ¨í„´ì„ ëŠì–´ë‚¼ ë•Œì…ë‹ˆë‹¤. ê´€ê³„ ë°©ì‹ì— ë³€í™”ë¥¼ ì¤„ í•„ìš”ê°€ ìˆìŠµë‹ˆë‹¤.",
          work: "ì •ë¦¬, êµ¬ì¡°ì¡°ì •, ë°©í–¥ ì „í™˜ì´ ì´ë¤„ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìƒˆ ì¶œë°œì„ ìœ„í•œ ë‹¨ê³„ë¡œ ë³´ì„¸ìš”."
        },
        reversed: {
          advice: "ë³€í™”ë¥¼ ë‘ë ¤ì›Œí•´ë„ ì‹œê°„ì€ íë¦…ë‹ˆë‹¤. ì‘ì€ ê²ƒë¶€í„° ì¡°ê¸ˆì”© ì •ë¦¬í•´ ë³´ì„¸ìš”.",
          overall: "ëë‚˜ì•¼ í•  ê²ƒì´ ì§ˆì§ˆ ëŒë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë¯¸ë¤„ë‘” ì¼ë“¤ì„ í•˜ë‚˜ì”© ì •ë¦¬í•´ ë³´ì„¸ìš”.",
          love: "ê³¼ê±° ë¯¸ë ¨, ì •ë¦¬ë˜ì§€ ì•Šì€ ê°ì •ì´ ë°œëª©ì„ ì¡ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
          work: "ë” ì´ìƒ ë„ì›€ì´ ë˜ì§€ ì•ŠëŠ” ë°©ì‹ì´ë‚˜ ì¼ì„ ë¶™ì¡ê³  ìˆëŠ”ì§€ ëŒì•„ë³¼ í•„ìš”ê°€ ìˆìŠµë‹ˆë‹¤."
        }
      },
      {
        name: "17. ë³„ (The Star)",
        keyword: "í¬ë§ Â· ì˜ê° Â· ì¹˜ìœ ",
        upright: {
          advice: "ì¡°ê¸ˆ ëŠë¦¬ë”ë¼ë„, ì˜ ê°€ê³  ìˆë‹¤ëŠ” ë¯¿ìŒì„ ê°€ì ¸ë³´ì„¸ìš”.",
          overall: "ë§ˆìŒì´ í•œê²° ê°€ë²¼ì›Œì§€ê³ , í¬ë§ì„ ëŠë‚„ ìˆ˜ ìˆëŠ” ë‚ ì…ë‹ˆë‹¤.",
          love: "ë”°ëœ»í•˜ê³  í¸ì•ˆí•œ êµê°ì´ ê°€ëŠ¥í•œ ë‚ ì…ë‹ˆë‹¤. ì§„ì†”í•œ ëŒ€í™”ê°€ ê´€ê³„ë¥¼ ë” ê°€ê¹ê²Œ ë§Œë“­ë‹ˆë‹¤.",
          work: "ì¥ê¸°ì ì¸ ëª©í‘œ, ë¹„ì „ì„ ë‹¤ì‹œ ì„¸ìš°ê¸° ì¢‹ìŠµë‹ˆë‹¤. ì˜ê°ì´ ë– ì˜¤ë¥´ê¸° ì‰¬ìš´ ë‚ ì…ë‹ˆë‹¤."
        },
        reversed: {
          advice: "ì§€ê¸ˆ ëŠë¼ëŠ” ë¶ˆì•ˆë„ ì˜ì›í•˜ì§€ ì•Šë‹¤ëŠ” ê±¸ ê¸°ì–µí•´ ì£¼ì„¸ìš”.",
          overall: "ì‹¤ë§, ë¬´ë ¥ê°ì„ ëŠë‚„ ìˆ˜ ìˆì§€ë§Œ, ì‘ì€ í¬ë§ì˜ ë¶ˆì”¨ëŠ” ì—¬ì „íˆ ë‚¨ì•„ ìˆìŠµë‹ˆë‹¤.",
          love: "ê¸°ëŒ€ì™€ í˜„ì‹¤ì˜ ì°¨ì´ ë•Œë¬¸ì— ì‹¤ë§í•  ìˆ˜ ìˆì–´ìš”. ìƒëŒ€ì—ê²Œ ë„ˆë¬´ ë§ì€ ê±¸ ê¸°ëŒ€í•˜ì§€ ë§ˆì„¸ìš”.",
          work: "ëª©í‘œê°€ íë¦¿í•˜ê²Œ ëŠê»´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì ì‹œ ì†ë„ë¥¼ ëŠ¦ì¶”ê³  ë°©í–¥ë¶€í„° ì¬ì •ë¹„í•˜ì„¸ìš”."
        }
      },
      {
        name: "19. íƒœì–‘ (The Sun)",
        keyword: "ì„±ê³µ Â· ê¸°ì¨ Â· ìì‹ ê°",
        upright: {
          advice: "ë‹¹ë‹¹í•˜ê²Œ ìì‹ ì„ ë“œëŸ¬ë‚´ ë³´ì„¸ìš”. ì˜¤ëŠ˜ì˜ ì£¼ì¸ê³µì€ ë°”ë¡œ ë‹¹ì‹ ì…ë‹ˆë‹¤.",
          overall: "ì—ë„ˆì§€ì™€ ìì‹ ê°ì´ ë„˜ì¹˜ëŠ” ë‚ ì…ë‹ˆë‹¤. ì¤‘ìš”í•œ ì¼ì„ ì¶”ì§„í•´ë„ ì¢‹ìŠµë‹ˆë‹¤.",
          love: "ì¦ê±°ìš´ ë°ì´íŠ¸, ë°ì€ ëŒ€í™”ê°€ ì˜ ì–´ìš¸ë¦¬ëŠ” í•˜ë£¨ì…ë‹ˆë‹¤.",
          work: "ì„±ê³¼ë¥¼ ì¸ì •ë°›ê±°ë‚˜, ì¢‹ì€ í‰ê°€ë¥¼ ë°›ì„ ìˆ˜ ìˆëŠ” ìš´ì…ë‹ˆë‹¤. ìì‹ ê° ìˆê²Œ ë‚˜ì•„ê°€ì„¸ìš”."
        },
        reversed: {
          advice: "ë„ˆë¬´ ì™„ë²½í•˜ë ¤ í•˜ì§€ ë§ê³ , ì§€ê¸ˆì˜ ì‘ì€ í–‰ë³µë¶€í„° ì°¾ì•„ë³´ì„¸ìš”.",
          overall: "ê¸°ëŒ€í•œ ë§Œí¼ì˜ ì„±ê³¼ê°€ ë‚˜ì˜¤ì§€ ì•Šì•„ë„, ì „ì²´ íë¦„ì€ ë‚˜ì˜ì§€ ì•ŠìŠµë‹ˆë‹¤.",
          love: "ì‚¬ì†Œí•œ ì˜¤í•´ë¡œ ë¶„ìœ„ê¸°ê°€ íë ¤ì§ˆ ìˆ˜ ìˆì–´ìš”. ë¨¼ì € ë°ê²Œ ë¶„ìœ„ê¸°ë¥¼ í’€ì–´ë³´ì„¸ìš”.",
          work: "ê³¼ì‹ , ìë§Œì„ ì¡°ì‹¬í•´ì•¼ í•©ë‹ˆë‹¤. ì˜í•˜ê³  ìˆë”ë¼ë„ í•­ìƒ ê¸°ë³¸ì„ ì ê²€í•˜ì„¸ìš”."
        }
      },
      {
        name: "21. ì„¸ê³„ (The World)",
        keyword: "ì™„ì„± Â· ì„±ì·¨ Â· ë§ˆë¬´ë¦¬",
        upright: {
          advice: "ì§€ê¸ˆê¹Œì§€ ì˜ ê±¸ì–´ì˜¨ ë‚˜ì—ê²Œ ì¹­ì°¬ì„ ê±´ë„¤ ì£¼ì„¸ìš”.",
          overall: "ì–´ëŠ í•˜ë‚˜ì˜ íë¦„ì´ ì˜ ë§ˆë¬´ë¦¬ë˜ê±°ë‚˜, ì„±ì·¨ê°ì„ ëŠë¼ê¸° ì¢‹ì€ ë‚ ì…ë‹ˆë‹¤.",
          love: "ê´€ê³„ê°€ í•œ ë‹¨ê³„ ì„±ìˆ™í•´ì§€ê±°ë‚˜, ì¤‘ìš”í•œ ê²°ì‹¬ì„ í•  ìˆ˜ ìˆëŠ” ì‹œì ì…ë‹ˆë‹¤.",
          work: "í”„ë¡œì íŠ¸ ì™„ìˆ˜, ëª©í‘œ ë‹¬ì„±ì˜ ê¸°ìš´ì´ ê°•í•©ë‹ˆë‹¤. ëê¹Œì§€ ë§ˆë¬´ë¦¬ì— í˜ì„ ì£¼ì„¸ìš”."
        },
        reversed: {
          advice: "ë§ˆì§€ë§‰ 1%ë¥¼ ì±„ìš°ê¸° ìœ„í•œ ì§‘ì¤‘ì´ í•„ìš”í•©ë‹ˆë‹¤. ì¡°ê¸ˆë§Œ ë” í˜ì„ ë‚´ë³´ì„¸ìš”.",
          overall: "ê±°ì˜ ë‹¤ ì™”ì§€ë§Œ, ì–´ë”˜ê°€ ë§ˆë¬´ë¦¬ê°€ ì• ë§¤í•˜ê²Œ ëŠê»´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
          love: "ê´€ê³„ì˜ ë‹¤ìŒ ë‹¨ê³„ë¡œ ë‚˜ì•„ê°€ëŠ” ë° ì£¼ì €í•¨ì´ ìˆì„ ìˆ˜ ìˆì–´ìš”. ì†”ì§í•œ ëŒ€í™”ê°€ í•„ìš”í•©ë‹ˆë‹¤.",
          work: "ë§ˆê°, ì œì¶œ, ë³´ê³  ë“± ë§ˆì§€ë§‰ ì •ë¦¬ê°€ ì¤‘ìš”í•©ë‹ˆë‹¤. ë””í…Œì¼ì„ ë‹¤ì‹œ ì ê²€í•´ ë³´ì„¸ìš”."
        }
      }
    ];

    const drawButton = document.getElementById("drawButton");
    const resetButton = document.getElementById("resetButton");
    const shareButton = document.getElementById("shareButton");
    const tarotCard = document.getElementById("tarotCard");

    const todayText = document.getElementById("todayText");
    const cardName = document.getElementById("cardName");
    const cardOrientation = document.getElementById("cardOrientation");
    const cardKeyword = document.getElementById("cardKeyword");
    const cardTag = document.getElementById("cardTag");

    const adviceText = document.getElementById("adviceText");
    const overallText = document.getElementById("overallText");
    const loveText = document.getElementById("loveText");
    const workText = document.getElementById("workText");

    const spreadPast = document.getElementById("spreadPast");
    const spreadPresent = document.getElementById("spreadPresent");
    const spreadFuture = document.getElementById("spreadFuture");
    const spreadMeaning = document.getElementById("spreadMeaning");
    const drawSpreadButton = document.getElementById("drawSpreadButton");

    function getTodayKey() {
      const now = new Date();
      const y = now.getFullYear();
      const m = String(now.getMonth() + 1).padStart(2, "0");
      const d = String(now.getDate()).padStart(2, "0");
      return `${y}-${m}-${d}`;
    }

    function formatKoreanDate() {
      const now = new Date();
      const y = now.getFullYear();
      const m = now.getMonth() + 1;
      const d = now.getDate();
      const weekdayNames = ["ì¼", "ì›”", "í™”", "ìˆ˜", "ëª©", "ê¸ˆ", "í† "];
      const w = weekdayNames[now.getDay()];
      return `${y}ë…„ ${m}ì›” ${d}ì¼ (${w})`;
    }

    function saveTodayResult(data) {
      const key = getTodayKey();
      localStorage.setItem("tarot_today_date", key);
      localStorage.setItem("tarot_today_data", JSON.stringify(data));
    }

    function loadTodayResult() {
      const key = getTodayKey();
      const savedDate = localStorage.getItem("tarot_today_date");
      const savedData = localStorage.getItem("tarot_today_data");

      if (!savedDate || !savedData) return null;
      if (savedDate !== key) return null;

      try {
        return JSON.parse(savedData);
      } catch (e) {
        return null;
      }
    }

    function clearTodayResult() {
      localStorage.removeItem("tarot_today_date");
      localStorage.removeItem("tarot_today_data");
    }

    function updateUIWithResult(result, animate = false) {
      const { cardIndex, isReversed } = result;
      const card = TAROT_CARDS[cardIndex];
      const data = isReversed ? card.reversed : card.upright;

      if (animate) {
        tarotCard.classList.add("flipped");
        setTimeout(() => {
          tarotCard.classList.remove("flipped");
        }, 450);
      }

      tarotCard.style.background = "linear-gradient(145deg, #1d2340, #3949ab)";

      cardName.textContent = card.name;
      cardOrientation.textContent = isReversed ? "ì—­ë°©í–¥ (Reversed)" : "ì •ë°©í–¥ (Upright)";
      cardKeyword.textContent = `í‚¤ì›Œë“œ: ${card.keyword}`;
      cardTag.textContent = isReversed ? "ì¡°ì‹¬ & ì •ë¦¬ì˜ ë‚ " : "ê¸°íšŒ & ì„±ì¥ì˜ ë‚ ";

      adviceText.textContent = data.advice;
      overallText.textContent = data.overall;
      loveText.textContent = data.love;
      workText.textContent = data.work;
    }

    function drawTodayCard() {
      let existing = loadTodayResult();
      if (existing) {
        updateUIWithResult(existing, true);
        return;
      }

      const randomIndex = Math.floor(Math.random() * TAROT_CARDS.length);
      const isReversed = Math.random() < 0.5;

      const result = {
        cardIndex: randomIndex,
        isReversed
      };

      saveTodayResult(result);
      updateUIWithResult(result, true);
    }

    function resetToday() {
      clearTodayResult();
      tarotCard.style.background =
        "radial-gradient(circle at top, #2c2f5e, #0c0f24)";
      cardName.textContent = "ì•„ì§ ì¹´ë“œë¥¼ ë½‘ì§€ ì•Šì•˜ì–´ìš”";
      cardOrientation.textContent = "ë²„íŠ¼ì„ ëˆŒëŸ¬ ì˜¤ëŠ˜ì˜ ì¹´ë“œë¥¼ ë½‘ì•„ë³´ì„¸ìš”.";
      cardKeyword.textContent = "";
      cardTag.textContent = "ê°€ë³ê²Œ ì¦ê¸°ëŠ” ìš´ì„¸";

      adviceText.textContent = "ì¹´ë“œë¥¼ ë½‘ì•„ì„œ ì˜¤ëŠ˜ì˜ ë©”ì‹œì§€ë¥¼ ë°›ì•„ë³´ì„¸ìš”.";
      overallText.textContent = "ì˜¤ëŠ˜ì˜ ì¹´ë“œê°€ ì •í•´ì§€ë©´ ì „ë°˜ì ì¸ íë¦„ì„ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤.";
      loveText.textContent = "ì¸ê°„ê´€ê³„, ì—°ì• , ê°€ì¡±, ë™ë£Œì™€ì˜ ê´€ê³„ íë¦„ì„ ì²´í¬í•´ë³´ì„¸ìš”.";
      workText.textContent = "ì¼, ê¸ˆì „, ê³„íšê³¼ ê´€ë ¨ëœ ë©”ì‹œì§€ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.";
    }

    function drawThreeCardSpread() {
      const indices = [];
      while (indices.length < 3) {
        const idx = Math.floor(Math.random() * TAROT_CARDS.length);
        if (!indices.includes(idx)) indices.push(idx);
      }

      const cards = indices.map(index => ({
        cardIndex: index,
        isReversed: Math.random() < 0.5
      }));

      [spreadPast, spreadPresent, spreadFuture].forEach(cardEl => {
        cardEl.classList.add("flipped");
        setTimeout(() => cardEl.classList.remove("flipped"), 300);
      });

      const positions = [
        { el: spreadPast, label: "ê³¼ê±°ì˜ ì˜í–¥" },
        { el: spreadPresent, label: "í˜„ì¬ì˜ ìƒí™©" },
        { el: spreadFuture, label: "ë‹¤ê°€ì˜¤ëŠ” íë¦„" }
      ];

      positions.forEach((pos, i) => {
        const el = pos.el;
        const data = cards[i];
        const card = TAROT_CARDS[data.cardIndex];

        el.querySelector(".spread-card-name").textContent = card.name;
        el.querySelector(".spread-card-orientation").textContent =
          (data.isReversed ? "ì—­ë°©í–¥" : "ì •ë°©í–¥") + " Â· " + pos.label;
        el.querySelector(".spread-card-keyword").textContent = `í‚¤ì›Œë“œ: ${card.keyword}`;
      });

      const pastCard = TAROT_CARDS[cards[0].cardIndex];
      const presentCard = TAROT_CARDS[cards[1].cardIndex];
      const futureCard = TAROT_CARDS[cards[2].cardIndex];

      spreadMeaning.textContent =
        `ê³¼ê±°ì—ëŠ” ã€Œ${pastCard.keyword}ã€ì˜ ê¸°ìš´ì´ í˜„ì¬ì— ì˜í–¥ì„ ì£¼ê³  ìˆê³ , ` +
        `ì§€ê¸ˆì€ ã€Œ${presentCard.keyword}ã€ì˜ íë¦„ ì†ì— ìˆìœ¼ë©°, ` +
        `ì•ìœ¼ë¡œëŠ” ã€Œ${futureCard.keyword}ã€ ë°©í–¥ìœ¼ë¡œ ì „ê°œë  ê°€ëŠ¥ì„±ì´ ë†’ë‹¤ëŠ” ë©”ì‹œì§€ì…ë‹ˆë‹¤. ` +
        `ê° ì¹´ë“œì˜ í‚¤ì›Œë“œë¥¼ ê³°ê³°ì´ ë– ì˜¬ë¦¬ë©´ì„œ ì˜¤ëŠ˜ì˜ ìƒí™©ê³¼ ì—°ê²°í•´ ë³´ì„¸ìš”.`;
    }

    function buildTodayShareText() {
      const date = todayText.textContent || getTodayKey();
      const name = cardName.textContent;
      const orientation = cardOrientation.textContent;
      const keyword = cardKeyword.textContent;
      const advice = adviceText.textContent;

      if (!name || name.includes("ì•„ì§ ì¹´ë“œë¥¼ ë½‘ì§€")) return null;

      return (
        `[íƒ€ë¡œ ì˜¤ëŠ˜ì˜ ìš´ì„¸]\n` +
        `${date}\n\n` +
        `ì¹´ë“œ: ${name} (${orientation})\n` +
        `${keyword}\n\n` +
        `í•œ ì¤„ ì¡°ì–¸: ${advice}\n\n` +
        `â€» ì—”í„°í…Œì¸ë¨¼íŠ¸ìš© íƒ€ë¡œì…ë‹ˆë‹¤.`
      );
    }

    async function shareTodayFortune() {
      const text = buildTodayShareText();
      if (!text) {
        alert("ë¨¼ì € ì˜¤ëŠ˜ì˜ ì¹´ë“œë¥¼ ë½‘ì•„ì£¼ì„¸ìš”!");
        return;
      }

      if (navigator.share) {
        try {
          await navigator.share({ title: "ì˜¤ëŠ˜ì˜ íƒ€ë¡œ ìš´ì„¸", text });
        } catch (e) {}
      } else if (navigator.clipboard) {
        try {
          await navigator.clipboard.writeText(text);
          alert("ì˜¤ëŠ˜ì˜ ìš´ì„¸ë¥¼ í´ë¦½ë³´ë“œì— ë³µì‚¬í–ˆìŠµë‹ˆë‹¤. ì›í•˜ëŠ” ê³³ì— ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš”!");
        } catch (e) {
          alert("ê³µìœ  ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ì–´ìš”. ëŒ€ì‹  ì§ì ‘ ë³µì‚¬í•´ì„œ ì‚¬ìš©í•´ ì£¼ì„¸ìš”.");
        }
      } else {
        alert("ê³µìœ  ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ì–´ìš”. ëŒ€ì‹  ì§ì ‘ ë³µì‚¬í•´ì„œ ì‚¬ìš©í•´ ì£¼ì„¸ìš”.\n\n" + text);
      }
    }

    function registerServiceWorker() {
      if ("serviceWorker" in navigator) {
        navigator.serviceWorker.register("sw.js").catch(() => {});
      }
    }

    function init() {
      todayText.textContent = formatKoreanDate();

      const saved = loadTodayResult();
      if (saved) updateUIWithResult(saved, false);

      drawButton.addEventListener("click", drawTodayCard);
      resetButton.addEventListener("click", () => {
        if (confirm("ì˜¤ëŠ˜ì˜ ê¸°ë¡ì„ ì§€ìš°ê³  ë‹¤ì‹œ ë½‘ì„ ìˆ˜ ìˆê²Œ í• ê¹Œìš”?")) resetToday();
      });

      drawSpreadButton.addEventListener("click", drawThreeCardSpread);
      shareButton.addEventListener("click", shareTodayFortune);

      registerServiceWorker();
    }

    init();
  </script>
</body>
</html>
